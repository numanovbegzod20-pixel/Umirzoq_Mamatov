<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>MedClinic ‚Äî Kirish</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #060d1a;
    --surface: #0d1626;
    --card: #111f35;
    --card2: #162440;
    --border: #1e3050;
    --accent: #38bdf8;
    --accent2: #34d399;
    --warning: #fbbf24;
    --danger: #f87171;
    --purple: #a78bfa;
    --text: #e2e8f0;
    --muted: #4e6580;
    --white: #fff;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Outfit', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ========== AUTH SCREENS ========== */
  .auth-screen {
    min-height: 100vh;
    display: flex; align-items: center; justify-content: center;
    padding: 20px;
    background:
      radial-gradient(ellipse at 20% 10%, rgba(56,189,248,0.1) 0%, transparent 50%),
      radial-gradient(ellipse at 80% 90%, rgba(52,211,153,0.07) 0%, transparent 50%),
      var(--bg);
  }
  .auth-wrap { width: 100%; max-width: 400px; }

  .auth-logo {
    text-align: center; margin-bottom: 32px;
  }
  .auth-logo-icon {
    width: 72px; height: 72px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 20px;
    display: inline-flex; align-items: center; justify-content: center;
    font-size: 36px; margin-bottom: 14px;
    box-shadow: 0 12px 40px rgba(56,189,248,0.25);
  }
  .auth-logo-name { font-size: 26px; font-weight: 800; color: var(--white); }
  .auth-logo-sub { font-size: 13px; color: var(--muted); margin-top: 4px; }

  .auth-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 24px;
    padding: 32px 28px;
    position: relative;
  }

  /* TAB switcher */
  .auth-tabs {
    display: flex;
    background: var(--surface);
    border-radius: 12px;
    padding: 4px;
    margin-bottom: 24px;
  }
  .auth-tab {
    flex: 1; padding: 9px;
    border: none; background: none;
    font-family: 'Outfit', sans-serif;
    font-size: 14px; font-weight: 600;
    color: var(--muted);
    border-radius: 9px;
    cursor: pointer; transition: all 0.2s;
  }
  .auth-tab.active {
    background: var(--card2);
    color: var(--accent);
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  }

  .auth-title { font-size: 20px; font-weight: 700; color: var(--white); margin-bottom: 4px; }
  .auth-sub { font-size: 13px; color: var(--muted); margin-bottom: 22px; }

  .inp {
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 13px 16px;
    color: var(--text);
    font-family: 'Outfit', sans-serif;
    font-size: 14px;
    outline: none;
    margin-bottom: 12px;
    transition: border-color 0.2s;
  }
  .inp:focus { border-color: var(--accent); }
  .inp::placeholder { color: var(--muted); }

  .inp-row { display: flex; gap: 10px; }
  .inp-row .inp { flex: 1; }

  .btn-main {
    width: 100%;
    background: linear-gradient(135deg, var(--accent), #0ea5e9);
    color: var(--white);
    border: none; border-radius: 12px;
    padding: 14px;
    font-family: 'Outfit', sans-serif;
    font-size: 15px; font-weight: 700;
    cursor: pointer; transition: all 0.2s;
    margin-top: 4px;
  }
  .btn-main:hover { transform: translateY(-1px); box-shadow: 0 8px 24px rgba(56,189,248,0.3); }
  .btn-main:active { transform: translateY(0); }

  .err-msg {
    background: rgba(248,113,113,0.1);
    border: 1px solid rgba(248,113,113,0.25);
    border-radius: 10px;
    padding: 10px 14px;
    color: var(--danger);
    font-size: 13px;
    margin-top: 12px;
    display: none;
  }
  .ok-msg {
    background: rgba(52,211,153,0.1);
    border: 1px solid rgba(52,211,153,0.25);
    border-radius: 10px;
    padding: 10px 14px;
    color: var(--accent2);
    font-size: 13px;
    margin-top: 12px;
    display: none;
  }

  .divider {
    display: flex; align-items: center; gap: 12px;
    margin: 18px 0;
  }
  .divider-line { flex: 1; height: 1px; background: var(--border); }
  .divider-text { font-size: 12px; color: var(--muted); }

  .admin-hint {
    text-align: center;
    font-size: 12px; color: var(--muted);
    margin-top: 18px;
    line-height: 1.6;
  }
  .admin-hint span { color: var(--accent); cursor: pointer; }
  .admin-hint span:hover { text-decoration: underline; }

  /* ========== SCREENS ========== */
  .screen { display: none; }
  .screen.active { display: block; }

  /* ========== USER AVATAR in auth ========== */
  .user-avatar-row {
    display: flex; align-items: center; gap: 12px;
    background: rgba(56,189,248,0.08);
    border: 1px solid rgba(56,189,248,0.2);
    border-radius: 12px;
    padding: 12px 14px;
    margin-bottom: 16px;
  }
  .user-av-circle {
    width: 40px; height: 40px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 18px; flex-shrink: 0;
  }
  .user-av-name { font-weight: 600; color: var(--white); font-size: 15px; }
  .user-av-sub { font-size: 12px; color: var(--accent); margin-top: 2px; }

  /* ========== CLINIC APP ========== */
  .app-header {
    background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%);
    padding: 20px 20px 28px;
    position: relative; overflow: hidden;
  }
  .app-header::before {
    content: '';
    position: absolute; width: 180px; height: 180px;
    background: radial-gradient(circle, rgba(56,189,248,0.15) 0%, transparent 70%);
    top: -50px; right: -30px; border-radius: 50%;
  }
  .app-header-top {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 16px;
  }
  .app-logo { display: flex; align-items: center; gap: 10px; }
  .app-logo-icon {
    width: 38px; height: 38px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 18px;
  }
  .app-logo-name { font-weight: 700; font-size: 16px; color: var(--white); }
  .app-user-btn {
    display: flex; align-items: center; gap: 8px;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 20px;
    padding: 6px 12px 6px 8px;
    cursor: pointer;
  }
  .app-user-av {
    width: 26px; height: 26px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 13px;
  }
  .app-user-name { font-size: 12px; font-weight: 600; color: var(--white); }

  .app-header h1 { font-size: 24px; font-weight: 700; color: var(--white); line-height: 1.2; margin-bottom: 6px; }
  .app-header h1 span { color: var(--accent); }
  .app-header p { font-size: 13px; color: #94a3b8; }

  /* NAV */
  .nav-tabs {
    display: flex; background: var(--surface);
    border-bottom: 1px solid var(--border);
    overflow-x: auto; scrollbar-width: none;
  }
  .nav-tabs::-webkit-scrollbar { display: none; }
  .tab-btn {
    flex: 1; min-width: 60px;
    padding: 12px 6px;
    background: none; border: none;
    color: var(--muted);
    font-family: 'Outfit', sans-serif;
    font-size: 11px; font-weight: 500;
    cursor: pointer;
    display: flex; flex-direction: column; align-items: center; gap: 3px;
    transition: all 0.2s;
    border-bottom: 2px solid transparent;
  }
  .tab-btn .icon { font-size: 18px; }
  .tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

  /* PAGES */
  .page { display: none; padding: 16px; animation: fadeIn 0.25s ease; }
  .page.active { display: block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

  /* CARDS */
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 12px;
  }
  .card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
  .avatar {
    width: 50px; height: 50px;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent2) 100%);
    border-radius: 13px;
    display: flex; align-items: center; justify-content: center;
    font-size: 22px; flex-shrink: 0;
  }
  .doctor-name { font-weight: 600; font-size: 15px; color: var(--white); }
  .doctor-spec {
    font-size: 12px; color: var(--accent);
    background: rgba(56,189,248,0.1);
    padding: 3px 8px; border-radius: 20px;
    display: inline-block; margin-top: 3px;
  }
  .doctor-info { display: flex; gap: 14px; margin-top: 10px; }
  .info-item { font-size: 12px; color: var(--muted); display: flex; align-items: center; gap: 4px; }
  .badge {
    background: rgba(52,211,153,0.1); color: var(--accent2);
    font-size: 11px; padding: 3px 10px; border-radius: 20px;
    border: 1px solid rgba(52,211,153,0.2);
  }

  .btn {
    width: 100%; padding: 13px;
    border: none; border-radius: 12px;
    font-family: 'Outfit', sans-serif; font-size: 14px; font-weight: 600;
    cursor: pointer; transition: all 0.2s; margin-top: 4px;
  }
  .btn-primary { background: linear-gradient(135deg, var(--accent), #0ea5e9); color: var(--white); }
  .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 6px 18px rgba(56,189,248,0.3); }
  .btn-outline { background: none; border: 1px solid var(--border); color: var(--text); }
  .btn-outline:hover { border-color: var(--accent); color: var(--accent); }

  .form-group { margin-bottom: 14px; }
  .form-label { font-size: 12px; font-weight: 500; color: var(--muted); margin-bottom: 6px; display: block; }
  .form-input, .form-select {
    width: 100%;
    background: var(--surface); border: 1px solid var(--border); border-radius: 12px;
    padding: 11px 14px; color: var(--text);
    font-family: 'Outfit', sans-serif; font-size: 14px; outline: none;
    transition: border-color 0.2s;
  }
  .form-input:focus, .form-select:focus { border-color: var(--accent); }
  .form-select option { background: var(--surface); }

  .price-row {
    display: flex; align-items: center; justify-content: space-between;
    padding: 11px 0; border-bottom: 1px solid var(--border);
  }
  .price-row:last-child { border-bottom: none; }
  .price-name { font-size: 14px; font-weight: 500; }
  .price-sub { font-size: 12px; color: var(--muted); margin-top: 2px; }
  .price-val { font-size: 15px; font-weight: 700; color: var(--accent); }

  .symptom-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
  .symptom-btn {
    background: var(--card); border: 1px solid var(--border); border-radius: 12px;
    padding: 12px 8px; text-align: center; cursor: pointer; transition: all 0.2s;
    display: flex; flex-direction: column; align-items: center; gap: 5px;
  }
  .symptom-btn:hover, .symptom-btn.selected { border-color: var(--accent); background: rgba(56,189,248,0.08); }
  .symptom-icon { font-size: 22px; }
  .symptom-text { font-size: 12px; font-weight: 500; color: var(--text); }

  .result-box {
    background: rgba(52,211,153,0.08); border: 1px solid rgba(52,211,153,0.3);
    border-radius: 14px; padding: 14px; margin-top: 14px; display: none;
  }
  .result-box h3 { color: var(--accent2); font-size: 14px; margin-bottom: 6px; }
  .result-box p { font-size: 13px; color: var(--text); line-height: 1.6; }

  .info-row {
    display: flex; align-items: flex-start; gap: 12px;
    padding: 12px 0; border-bottom: 1px solid var(--border);
  }
  .info-row:last-child { border-bottom: none; }
  .info-icon { font-size: 20px; flex-shrink: 0; }
  .info-title { font-size: 13px; font-weight: 600; color: var(--white); }
  .info-desc { font-size: 12px; color: var(--muted); margin-top: 3px; line-height: 1.5; }

  .section-title { font-size: 17px; font-weight: 700; color: var(--white); margin-bottom: 14px; }
  .section-sub { font-size: 13px; color: var(--muted); margin-bottom: 14px; }

  /* CONFIRM MODAL */
  .modal-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.7); z-index: 100;
    align-items: flex-end;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: var(--card); border-radius: 24px 24px 0 0;
    padding: 26px 20px 38px; width: 100%;
    animation: slideUp 0.3s ease;
  }
  @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
  .modal h2 { font-size: 19px; font-weight: 700; color: var(--white); margin-bottom: 4px; }
  .modal-sub-text { font-size: 13px; color: var(--muted); margin-bottom: 18px; }
  .confirm-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: 9px 0; border-bottom: 1px solid var(--border); font-size: 14px;
  }
  .confirm-row:last-of-type { border-bottom: none; }
  .confirm-label { color: var(--muted); }
  .confirm-val { color: var(--white); font-weight: 500; }
  .success-icon { font-size: 56px; text-align: center; margin: 10px 0; animation: pop 0.5s cubic-bezier(0.175,0.885,0.32,1.275); }
  @keyframes pop { from { transform: scale(0); } to { transform: scale(1); } }

  /* ========== ADMIN PANEL ========== */
  .layout { display: flex; min-height: 100vh; }
  .sidebar {
    width: 230px; flex-shrink: 0;
    background: var(--surface); border-right: 1px solid var(--border);
    display: flex; flex-direction: column;
    position: fixed; top: 0; left: 0; bottom: 0; z-index: 10;
  }
  .sidebar-logo {
    padding: 22px 18px 18px; border-bottom: 1px solid var(--border);
    display: flex; align-items: center; gap: 10px;
  }
  .s-logo-icon {
    width: 38px; height: 38px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px;
  }
  .s-logo-name { font-size: 14px; font-weight: 700; color: var(--white); }
  .s-logo-sub { font-size: 11px; color: var(--accent); }
  .sidebar-nav { padding: 14px 10px; flex: 1; }
  .nav-label { font-size: 10px; font-weight: 600; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; padding: 5px 8px 3px; }
  .nav-item {
    display: flex; align-items: center; gap: 9px;
    padding: 9px 11px; border-radius: 10px; cursor: pointer;
    font-size: 13px; font-weight: 500; color: var(--muted);
    transition: all 0.15s; margin-bottom: 2px;
  }
  .nav-item:hover { background: var(--card); color: var(--text); }
  .nav-item.active { background: rgba(56,189,248,0.12); color: var(--accent); }
  .nav-icon { font-size: 16px; width: 20px; text-align: center; }
  .nav-badge {
    margin-left: auto; background: var(--accent); color: var(--bg);
    font-size: 10px; font-weight: 700; padding: 2px 6px; border-radius: 20px;
  }
  .nav-badge.warn { background: var(--warning); }
  .sidebar-footer { padding: 14px 10px; border-top: 1px solid var(--border); }
  .admin-user-card {
    display: flex; align-items: center; gap: 9px;
    background: var(--card); border-radius: 10px; padding: 9px 11px; margin-bottom: 8px;
  }
  .admin-user-av {
    width: 32px; height: 32px;
    background: linear-gradient(135deg, var(--purple), var(--accent));
    border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 15px;
  }
  .admin-user-name { font-size: 13px; font-weight: 600; color: var(--white); }
  .admin-user-role { font-size: 11px; color: var(--muted); }
  .btn-logout {
    width: 100%;
    background: rgba(248,113,113,0.1); border: 1px solid rgba(248,113,113,0.2);
    color: var(--danger); border-radius: 10px; padding: 8px;
    font-family: 'Outfit', sans-serif; font-size: 13px; font-weight: 600;
    cursor: pointer; transition: all 0.2s;
  }
  .btn-logout:hover { background: rgba(248,113,113,0.2); }

  .admin-main { margin-left: 230px; flex: 1; }
  .topbar {
    background: var(--surface); border-bottom: 1px solid var(--border);
    padding: 14px 24px;
    display: flex; align-items: center; justify-content: space-between;
    position: sticky; top: 0; z-index: 5;
  }
  .topbar-title { font-size: 18px; font-weight: 700; color: var(--white); }
  .topbar-sub { font-size: 12px; color: var(--muted); margin-top: 1px; }
  .topbar-right { display: flex; align-items: center; gap: 10px; }
  .date-chip {
    background: var(--card); border: 1px solid var(--border);
    border-radius: 10px; padding: 7px 12px; font-size: 12px; color: var(--muted);
  }
  .notif-btn {
    width: 36px; height: 36px; background: var(--card); border: 1px solid var(--border);
    border-radius: 10px; display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 16px; position: relative;
  }
  .notif-dot { position: absolute; top: 6px; right: 6px; width: 7px; height: 7px; background: var(--danger); border-radius: 50%; }

  .admin-content { padding: 20px 24px; }
  .stats-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 14px; margin-bottom: 20px; }
  .stat-card {
    background: var(--card); border: 1px solid var(--border);
    border-radius: 16px; padding: 18px; position: relative; overflow: hidden;
  }
  .stat-card::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px; border-radius: 0 0 16px 16px; }
  .stat-card.blue::after { background: var(--accent); }
  .stat-card.green::after { background: var(--accent2); }
  .stat-card.yellow::after { background: var(--warning); }
  .stat-card.purple::after { background: var(--purple); }
  .stat-icon { font-size: 26px; margin-bottom: 10px; }
  .stat-val { font-size: 28px; font-weight: 800; color: var(--white); }
  .stat-label { font-size: 12px; color: var(--muted); margin-top: 4px; }

  .a-section { margin-bottom: 20px; }
  .a-section-head { display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px; }
  .a-section-title { font-size: 16px; font-weight: 700; color: var(--white); }
  .a-section-sub { font-size: 12px; color: var(--muted); margin-top: 2px; }

  .filters { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 14px; align-items: center; }
  .filter-inp {
    background: var(--card); border: 1px solid var(--border); border-radius: 10px;
    padding: 8px 12px; color: var(--text);
    font-family: 'Outfit', sans-serif; font-size: 12px; outline: none; transition: border-color 0.2s;
  }
  .filter-inp:focus { border-color: var(--accent); }
  .filter-inp::placeholder { color: var(--muted); }
  .filter-select {
    background: var(--card); border: 1px solid var(--border); border-radius: 10px;
    padding: 8px 12px; color: var(--text);
    font-family: 'Outfit', sans-serif; font-size: 12px; outline: none; cursor: pointer;
  }
  .filter-select option { background: var(--surface); }
  .btn-sm {
    padding: 8px 14px; border: none; border-radius: 10px;
    font-family: 'Outfit', sans-serif; font-size: 12px; font-weight: 600;
    cursor: pointer; transition: all 0.2s;
  }
  .btn-accent { background: linear-gradient(135deg, var(--accent), #0ea5e9); color: var(--white); }
  .btn-accent:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(56,189,248,0.3); }
  .btn-ghost { background: var(--card); border: 1px solid var(--border); color: var(--muted); }
  .btn-ghost:hover { color: var(--text); border-color: var(--accent); }

  .table-wrap { background: var(--card); border: 1px solid var(--border); border-radius: 16px; overflow: hidden; overflow-x: auto; }
  table { width: 100%; border-collapse: collapse; min-width: 600px; }
  thead tr { background: var(--card2); }
  th { padding: 11px 14px; text-align: left; font-size: 10px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 0.8px; border-bottom: 1px solid var(--border); white-space: nowrap; }
  td { padding: 12px 14px; font-size: 13px; border-bottom: 1px solid rgba(30,48,80,0.5); vertical-align: middle; }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: rgba(56,189,248,0.03); }
  .td-name { font-weight: 600; color: var(--white); }
  .td-phone { color: var(--accent); font-size: 12px; }
  .td-date { color: var(--muted); font-size: 12px; }

  .status-badge {
    display: inline-flex; align-items: center; gap: 4px;
    padding: 3px 9px; border-radius: 20px; font-size: 11px; font-weight: 600; white-space: nowrap;
  }
  .status-new { background: rgba(56,189,248,0.12); color: var(--accent); border: 1px solid rgba(56,189,248,0.2); }
  .status-confirmed { background: rgba(52,211,153,0.12); color: var(--accent2); border: 1px solid rgba(52,211,153,0.2); }
  .status-done { background: rgba(100,116,139,0.15); color: var(--muted); border: 1px solid rgba(100,116,139,0.2); }
  .status-cancelled { background: rgba(248,113,113,0.12); color: var(--danger); border: 1px solid rgba(248,113,113,0.2); }

  .action-btn {
    width: 28px; height: 28px; background: var(--card2); border: 1px solid var(--border);
    border-radius: 7px; display: inline-flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 13px; transition: all 0.15s; margin-right: 3px;
  }
  .action-btn:hover { border-color: var(--accent); background: rgba(56,189,248,0.1); }
  .action-btn.danger:hover { border-color: var(--danger); background: rgba(248,113,113,0.1); }

  .empty-state { text-align: center; padding: 50px 20px; color: var(--muted); }
  .empty-icon { font-size: 40px; margin-bottom: 10px; }
  .empty-text { font-size: 14px; font-weight: 600; color: var(--text); }
  .empty-sub { font-size: 12px; margin-top: 4px; }

  .a-modal-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.7); z-index: 100;
    align-items: center; justify-content: center; padding: 20px;
  }
  .a-modal-overlay.open { display: flex; }
  .a-modal {
    background: var(--card); border: 1px solid var(--border);
    border-radius: 20px; padding: 24px; width: 100%; max-width: 460px;
    animation: fadeIn2 0.2s ease; max-height: 90vh; overflow-y: auto;
  }
  @keyframes fadeIn2 { from { opacity:0; transform:scale(0.97); } to { opacity:1; transform:scale(1); } }
  .a-modal h3 { font-size: 17px; font-weight: 700; color: var(--white); margin-bottom: 3px; }
  .a-modal-sub { font-size: 12px; color: var(--muted); margin-bottom: 18px; }
  .m-row { display: flex; gap: 10px; margin-bottom: 10px; }
  .m-row .inp { margin-bottom: 0; }
  .m-footer { display: flex; gap: 8px; margin-top: 16px; }
  .m-footer .btn-sm { flex: 1; padding: 11px; font-size: 13px; }

  .detail-row { display: flex; justify-content: space-between; padding: 9px 0; border-bottom: 1px solid var(--border); font-size: 13px; }
  .detail-row:last-child { border-bottom: none; }
  .detail-label { color: var(--muted); }
  .detail-val { color: var(--white); font-weight: 500; }

  .admin-page { display: none; }
  .admin-page.active { display: block; }

  .toast {
    position: fixed; top: 16px; right: 16px;
    font-weight: 600; font-size: 13px;
    padding: 11px 18px; border-radius: 12px;
    z-index: 999; display: none;
    animation: slideIn 0.3s ease;
  }
  @keyframes slideIn { from { transform:translateX(100px); opacity:0; } to { transform:translateX(0); opacity:1; } }

  @media (max-width: 768px) {
    .stats-grid { grid-template-columns: 1fr 1fr; }
    .sidebar { display: none; }
    .admin-main { margin-left: 0; }
    .admin-content { padding: 14px; }
    .topbar { padding: 12px 14px; }
  }
</style>
</head>
<body>

<!-- ===== SCREEN 1: AUTH ===== -->
<div class="screen active" id="screen-auth">
  <div class="auth-screen">
    <div class="auth-wrap">
      <div class="auth-logo">
        <div class="auth-logo-icon">üè•</div>
        <div class="auth-logo-name">MedClinic</div>
        <div class="auth-logo-sub">Online Qabul Markazi</div>
      </div>
      <div class="auth-card">
        <div class="auth-tabs">
          <button class="auth-tab active" id="tab-register" onclick="switchTab('register')">üìù Ro'yxatdan o'tish</button>
          <button class="auth-tab" id="tab-login" onclick="switchTab('login')">üîë Kirish</button>
        </div>

        <!-- REGISTER FORM -->
        <div id="form-register">
          <div class="auth-title">Ro'yxatdan o'ting</div>
          <div class="auth-sub">Birinchi marta foydalanayapsizmi? Hisob oching</div>
          <div class="inp-row">
            <input type="text" class="inp" id="r-fname" placeholder="Ism">
            <input type="text" class="inp" id="r-lname" placeholder="Familiya">
          </div>
          <input type="tel" class="inp" id="r-phone" placeholder="üìû Telefon: +998 90 000 00 00">
          <input type="password" class="inp" id="r-pass" placeholder="üîí Parol (kamida 4 belgi)">
          <input type="password" class="inp" id="r-pass2" placeholder="üîí Parolni tasdiqlang">
          <button class="btn-main" onclick="doRegister()">Ro'yxatdan o'tish ‚Üí</button>
          <div class="err-msg" id="r-err"></div>
          <div class="ok-msg" id="r-ok"></div>
          <div class="divider"><div class="divider-line"></div><div class="divider-text">yoki</div><div class="divider-line"></div></div>
          <div class="admin-hint">Allaqachon hisobingiz bormi? <span onclick="switchTab('login')">Kirish</span></div>
        </div>

        <!-- LOGIN FORM -->
        <div id="form-login" style="display:none;">
          <div class="auth-title">Xush kelibsiz! üëã</div>
          <div class="auth-sub">Telefon raqam va parol bilan kiring</div>
          <input type="tel" class="inp" id="l-phone" placeholder="üìû Telefon raqam">
          <input type="password" class="inp" id="l-pass" placeholder="üîí Parol">
          <button class="btn-main" onclick="doLogin()">Kirish ‚Üí</button>
          <div class="err-msg" id="l-err"></div>
          <div class="divider"><div class="divider-line"></div><div class="divider-text">yoki</div><div class="divider-line"></div></div>
          <div class="admin-hint">
            Hisobingiz yo'qmi? <span onclick="switchTab('register')">Ro'yxatdan o'tish</span><br>
            <span onclick="switchTab('admin')" style="color:var(--muted);">üîê Admin sifatida kirish</span>
          </div>
        </div>

        <!-- ADMIN LOGIN -->
        <div id="form-admin" style="display:none;">
          <div class="auth-title">Admin Kirish üîê</div>
          <div class="auth-sub">Admin login va parol bilan kiring</div>
          <input type="text" class="inp" id="a-user" placeholder="üë§ Admin login" value="admin">
          <input type="password" class="inp" id="a-pass" placeholder="üîí Parol">
          <button class="btn-main" onclick="doAdminLogin()">Admin paneliga kirish ‚Üí</button>
          <div class="err-msg" id="a-err"></div>
          <div class="divider"><div class="divider-line"></div><div class="divider-text">yoki</div><div class="divider-line"></div></div>
          <div class="admin-hint"><span onclick="switchTab('login')">‚Üê Orqaga qaytish</span></div>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- ===== SCREEN 2: CLINIC APP ===== -->
<div class="screen" id="screen-app">
  <div class="app-header">
    <div class="app-header-top">
      <div class="app-logo">
        <div class="app-logo-icon">üè•</div>
        <div class="app-logo-name">MedClinic</div>
      </div>
      <div class="app-user-btn" onclick="showUserMenu()">
        <div class="app-user-av" id="app-user-av">üë§</div>
        <div class="app-user-name" id="app-user-name">Foydalanuvchi</div>
      </div>
    </div>
    <h1>Sog'ligingiz ‚Äî<br><span>bizning ustuvorlik</span></h1>
    <p id="app-greet">Xush kelibsiz!</p>
  </div>

  <div class="nav-tabs">
    <button class="tab-btn active" onclick="showPage('home')" id="ptab-home"><span class="icon">üè†</span>Bosh</button>
    <button class="tab-btn" onclick="showPage('doctors')" id="ptab-doctors"><span class="icon">üë®‚Äç‚öïÔ∏è</span>Shifokorlar</button>
    <button class="tab-btn" onclick="showPage('booking')" id="ptab-booking"><span class="icon">üìÖ</span>Yozilish</button>
    <button class="tab-btn" onclick="showPage('prices')" id="ptab-prices"><span class="icon">üí∞</span>Narxlar</button>
    <button class="tab-btn" onclick="showPage('symptom')" id="ptab-symptom"><span class="icon">üîç</span>Triaj</button>
    <button class="tab-btn" onclick="showPage('info')" id="ptab-info"><span class="icon">üìç</span>Info</button>
    <button class="tab-btn" onclick="showPage('profile')" id="ptab-profile"><span class="icon">üë§</span>Profil</button>
  </div>

  <!-- HOME -->
  <div class="page active" id="page-home">
    <div style="text-align:center;padding:10px 0 16px;">
      <div style="font-size:50px;margin-bottom:10px;">üè•</div>
      <div class="section-title" id="home-welcome">Xush kelibsiz!</div>
      <div class="section-sub">Quyidagi xizmatlardan birini tanlang</div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
      <div class="card" style="text-align:center;cursor:pointer;" onclick="showPage('booking')">
        <div style="font-size:32px;margin-bottom:6px;">üìÖ</div>
        <div style="font-weight:600;font-size:13px;color:var(--white);">Qabul yozilish</div>
        <div style="font-size:11px;color:var(--muted);margin-top:3px;">Shifokorga yoziling</div>
      </div>
      <div class="card" style="text-align:center;cursor:pointer;" onclick="showPage('doctors')">
        <div style="font-size:32px;margin-bottom:6px;">üë®‚Äç‚öïÔ∏è</div>
        <div style="font-weight:600;font-size:13px;color:var(--white);">Shifokorlar</div>
        <div style="font-size:11px;color:var(--muted);margin-top:3px;">Mutaxassislar</div>
      </div>
      <div class="card" style="text-align:center;cursor:pointer;" onclick="showPage('prices')">
        <div style="font-size:32px;margin-bottom:6px;">üí∞</div>
        <div style="font-weight:600;font-size:13px;color:var(--white);">Narxlar</div>
        <div style="font-size:11px;color:var(--muted);margin-top:3px;">Xizmat narxlari</div>
      </div>
      <div class="card" style="text-align:center;cursor:pointer;" onclick="showPage('symptom')">
        <div style="font-size:32px;margin-bottom:6px;">üîç</div>
        <div style="font-weight:600;font-size:13px;color:var(--white);">Triaj</div>
        <div style="font-size:11px;color:var(--muted);margin-top:3px;">Qaysi shifokor?</div>
      </div>
    </div>
    <div class="card" style="margin-top:4px;">
      <div class="info-row" style="padding-top:0;"><div class="info-icon">‚è∞</div><div><div class="info-title">Ish vaqti</div><div class="info-desc">Dushanba ‚Äì Shanba: 08:00 ‚Äì 20:00</div></div></div>
      <div class="info-row" style="padding-bottom:0;"><div class="info-icon">üìû</div><div><div class="info-title">Telefon</div><div class="info-desc">+998 71 234 56 78</div></div></div>
    </div>
  </div>

  <!-- DOCTORS -->
  <div class="page" id="page-doctors">
    <div class="section-title">Shifokorlarimiz</div>
    <div class="card">
      <div class="card-header"><div class="avatar">ü¶∑</div><div><div class="doctor-name">Dr. Aziz Karimov</div><div class="doctor-spec">Stomatolog</div></div></div>
      <div class="doctor-info"><div class="info-item"><span>‚≠ê</span>4.9</div><div class="info-item"><span>üïê</span>8 yil</div></div>
      <div style="font-size:12px;color:var(--muted);margin-top:8px;">Tish kasalliklari, protezlash va implantatsiya.</div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;"><span class="badge">‚úÖ Bo'sh</span><span style="font-size:11px;color:var(--muted);">08:00‚Äì18:00</span></div>
      <button class="btn btn-primary" onclick="selectDoctor('Dr. Aziz Karimov ‚Äî Stomatolog')">Yozilish</button>
    </div>
    <div class="card">
      <div class="card-header"><div class="avatar">üëÅÔ∏è</div><div><div class="doctor-name">Dr. Nilufar Yusupova</div><div class="doctor-spec">LOR</div></div></div>
      <div class="doctor-info"><div class="info-item"><span>‚≠ê</span>4.8</div><div class="info-item"><span>üïê</span>12 yil</div></div>
      <div style="font-size:12px;color:var(--muted);margin-top:8px;">Quloq, burun, tomoq kasalliklari.</div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;"><span class="badge">‚úÖ Bo'sh</span><span style="font-size:11px;color:var(--muted);">09:00‚Äì17:00</span></div>
      <button class="btn btn-primary" onclick="selectDoctor('Dr. Nilufar Yusupova ‚Äî LOR')">Yozilish</button>
    </div>
    <div class="card">
      <div class="card-header"><div class="avatar">üë∂</div><div><div class="doctor-name">Dr. Sardor Toshmatov</div><div class="doctor-spec">Pediatr</div></div></div>
      <div class="doctor-info"><div class="info-item"><span>‚≠ê</span>4.9</div><div class="info-item"><span>üïê</span>6 yil</div></div>
      <div style="font-size:12px;color:var(--muted);margin-top:8px;">Bolalar kasalliklari va profilaktika.</div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;"><span class="badge">‚úÖ Bo'sh</span><span style="font-size:11px;color:var(--muted);">08:00‚Äì20:00</span></div>
      <button class="btn btn-primary" onclick="selectDoctor('Dr. Sardor Toshmatov ‚Äî Pediatr')">Yozilish</button>
    </div>
    <div class="card">
      <div class="card-header"><div class="avatar">ü´Ä</div><div><div class="doctor-name">Dr. Mohira Xasanova</div><div class="doctor-spec">Kardiolog</div></div></div>
      <div class="doctor-info"><div class="info-item"><span>‚≠ê</span>5.0</div><div class="info-item"><span>üïê</span>15 yil</div></div>
      <div style="font-size:12px;color:var(--muted);margin-top:8px;">Yurak-qon tomir kasalliklari.</div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;"><span style="background:rgba(248,113,113,0.1);color:var(--danger);font-size:11px;padding:3px 10px;border-radius:20px;border:1px solid rgba(248,113,113,0.2);">üïê Band</span><span style="font-size:11px;color:var(--muted);">10:00‚Äì16:00</span></div>
      <button class="btn btn-outline" onclick="selectDoctor('Dr. Mohira Xasanova ‚Äî Kardiolog')">Kutish ro'yxatiga</button>
    </div>
  </div>

  <!-- BOOKING -->
  <div class="page" id="page-booking">
    <div class="section-title">Qabul Yozilish</div>
    <div class="card">
      <div class="form-group"><label class="form-label">üë§ Ism Familiyangiz</label><input type="text" class="form-input" id="b-name" placeholder="Masalan: Alisher Karimov"></div>
      <div class="form-group"><label class="form-label">üìû Telefon</label><input type="tel" class="form-input" id="b-phone" placeholder="+998 90 000 00 00"></div>
      <div class="form-group"><label class="form-label">ü©∫ Shifokor</label>
        <select class="form-select" id="b-doctor">
          <option value="">‚Äî Tanlang ‚Äî</option>
          <option>Dr. Aziz Karimov ‚Äî Stomatolog</option>
          <option>Dr. Nilufar Yusupova ‚Äî LOR</option>
          <option>Dr. Sardor Toshmatov ‚Äî Pediatr</option>
          <option>Dr. Mohira Xasanova ‚Äî Kardiolog</option>
        </select>
      </div>
      <div class="form-group"><label class="form-label">üìÖ Sana</label><input type="date" class="form-input" id="b-date"></div>
      <div class="form-group"><label class="form-label">‚è∞ Vaqt</label>
        <select class="form-select" id="b-time">
          <option value="">‚Äî Vaqt ‚Äî</option>
          <option>08:00</option><option>08:30</option><option>09:00</option><option>09:30</option>
          <option>10:00</option><option>10:30</option><option>11:00</option><option>11:30</option>
          <option>14:00</option><option>14:30</option><option>15:00</option><option>15:30</option>
          <option>16:00</option><option>16:30</option>
        </select>
      </div>
      <div class="form-group"><label class="form-label">üìù Izoh (ixtiyoriy)</label><input type="text" class="form-input" id="b-note" placeholder="Qisqacha ta'riflang..."></div>
      <button class="btn btn-primary" onclick="openConfirm()">‚úÖ Tasdiqlash</button>
    </div>
  </div>

  <!-- PRICES -->
  <div class="page" id="page-prices">
    <div class="section-title">Xizmat Narxlari</div>
    <div style="font-size:12px;color:var(--muted);margin-bottom:14px;text-align:center;">RITM KLINIKASI ‚Äî rasmiy narxlar</div>

    <!-- TIBBIY XIZMATLAR -->
    <div class="card">
      <div style="font-size:12px;font-weight:700;color:var(--accent);margin-bottom:10px;text-transform:uppercase;letter-spacing:0.5px;">üè• Tibbiy Xizmatlar</div>
      <div class="price-row">
        <div><div class="price-name">Shifokor ko'rigi</div></div>
        <div style="text-align:right;"><div class="price-val">40 000 ‚Äì 50 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">UZI (umumiy)</div></div>
        <div style="text-align:right;"><div class="price-val">70 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">EKG</div></div>
        <div style="text-align:right;"><div class="price-val">20 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Statsionar davolanish</div><div class="price-sub">Nonushta, tushlik, kechki ovqat, fizioterapiya</div></div>
        <div style="text-align:right;"><div class="price-val">150 000 ‚Äì 180 000</div><div style="font-size:11px;color:var(--muted);">so'm / kun</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Ambulator davolanish</div></div>
        <div style="text-align:right;"><div class="price-val">50 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Ozonoterapiya</div></div>
        <div style="text-align:right;"><div class="price-val">30 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Igna terapiya</div></div>
        <div style="text-align:right;"><div class="price-val">50 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Fizioterapiya apparatidan muolaja</div><div class="price-sub">Har bir apparat uchun</div></div>
        <div style="text-align:right;"><div class="price-val">20 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">EEG</div></div>
        <div style="text-align:right;"><div class="price-val">100 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Massaj</div></div>
        <div style="text-align:right;"><div class="price-val">30 000 ‚Äì 80 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
    </div>

    <!-- LABORATORIYA -->
    <div class="card">
      <div style="font-size:12px;font-weight:700;color:var(--accent2);margin-bottom:10px;text-transform:uppercase;letter-spacing:0.5px;">üî¨ Laboratoriya</div>
      <div class="price-row">
        <div><div class="price-name">Gemoglobin</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">55 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Siydik tahlili</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">30 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">PTI</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">30 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">BTA (ALT, AST)</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">55 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Qand miqdori</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">30 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Kalsiy</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">30 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Xolesterin</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">30 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Mochevina</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">30 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">Kreatinin</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">30 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">ASLO</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">35 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">RF</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">35 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
      <div class="price-row">
        <div><div class="price-name">SRB</div></div>
        <div style="text-align:right;"><div class="price-val" style="color:var(--accent2);">35 000</div><div style="font-size:11px;color:var(--muted);">so'm</div></div>
      </div>
    </div>
  </div>

  <!-- SYMPTOM -->
  <div class="page" id="page-symptom">
    <div class="section-title">Qaysi Shifokor Kerak?</div>
    <div class="section-sub">Simptomingizni tanlang</div>
    <div class="symptom-grid">
      <div class="symptom-btn" onclick="showResult(this,'head')"><div class="symptom-icon">ü§ï</div><div class="symptom-text">Bosh og'riq</div></div>
      <div class="symptom-btn" onclick="showResult(this,'teeth')"><div class="symptom-icon">ü¶∑</div><div class="symptom-text">Tish og'riq</div></div>
      <div class="symptom-btn" onclick="showResult(this,'stomach')"><div class="symptom-icon">ü§¢</div><div class="symptom-text">Qorin og'riq</div></div>
      <div class="symptom-btn" onclick="showResult(this,'heart')"><div class="symptom-icon">ü´Ä</div><div class="symptom-text">Ko'krak og'riq</div></div>
      <div class="symptom-btn" onclick="showResult(this,'nose')"><div class="symptom-icon">ü§ß</div><div class="symptom-text">Burun / Tomoq</div></div>
      <div class="symptom-btn" onclick="showResult(this,'child')"><div class="symptom-icon">üë∂</div><div class="symptom-text">Bola kasal</div></div>
      <div class="symptom-btn" onclick="showResult(this,'eye')"><div class="symptom-icon">üëÅÔ∏è</div><div class="symptom-text">Ko'z muammosi</div></div>
      <div class="symptom-btn" onclick="showResult(this,'joint')"><div class="symptom-icon">ü¶¥</div><div class="symptom-text">Bo'g'im og'riq</div></div>
    </div>
    <div class="result-box" id="result-box">
      <h3 id="result-title">Tavsiya</h3>
      <p id="result-text"></p>
      <button class="btn btn-primary" style="margin-top:10px;" onclick="showPage('booking')">Yozilish ‚Üí</button>
    </div>
    <div style="font-size:11px;color:var(--muted);margin-top:14px;text-align:center;">‚ö†Ô∏è Bu faqat yo'naltirish uchun. Tashxis faqat shifokor tomonidan qo'yiladi.</div>
  </div>

  <!-- INFO -->
  <div class="page" id="page-info">
    <div class="section-title">Klinika Ma'lumotlari</div>
    <div class="card">
      <div class="info-row" style="padding-top:0;"><div class="info-icon">üìç</div><div><div class="info-title">Manzil</div><div class="info-desc">Toshkent sh., Chilonzor tumani,<br>Bunyodkor ko'chasi 12-uy</div></div></div>
      <div class="info-row"><div class="info-icon">‚è∞</div><div><div class="info-title">Ish vaqti</div><div class="info-desc">Dushanba‚ÄìJuma: 08:00‚Äì20:00<br>Shanba: 09:00‚Äì17:00</div></div></div>
      <div class="info-row"><div class="info-icon">üìû</div><div><div class="info-title">Telefon</div><div class="info-desc">+998 71 234 56 78</div></div></div>
      <div class="info-row" style="padding-bottom:0;"><div class="info-icon">üí¨</div><div><div class="info-title">Telegram</div><div class="info-desc">@medclinic_uz</div></div></div>
    </div>
    <button class="btn btn-primary" onclick="window.open('https://maps.google.com/?q=41.2995,69.2401','_blank')">üó∫Ô∏è Xaritada ko'rish</button>
  </div>

  <!-- PROFILE -->
  <div class="page" id="page-profile">
    <div class="section-title">Mening Profilim</div>
    <div class="card" id="profile-info"></div>
    <div class="card">
      <div class="section-title" style="font-size:15px;margin-bottom:12px;">üìã Mening yozilishlarim</div>
      <div id="my-bookings-list"></div>
    </div>
    <button class="btn btn-outline" style="margin-top:4px;" onclick="doAppLogout()">üö™ Chiqish</button>
  </div>

  <!-- CONFIRM MODAL -->
  <div class="modal-overlay" id="confirm-modal" onclick="closeConfirmOutside(event)">
    <div class="modal">
      <div id="modal-confirm-form">
        <h2>Tasdiqlash</h2>
        <div class="modal-sub-text">Ma'lumotlarni tekshirib, tasdiqlang</div>
        <div id="confirm-details"></div>
        <button class="btn btn-primary" style="margin-top:18px;" onclick="submitBooking()">‚úÖ Qabul yozilish</button>
        <button class="btn btn-outline" style="margin-top:8px;" onclick="document.getElementById('confirm-modal').classList.remove('open')">Bekor qilish</button>
      </div>
      <div id="modal-confirm-success" style="display:none;text-align:center;">
        <div class="success-icon">üéâ</div>
        <h2>Muvaffaqiyatli!</h2>
        <p style="color:var(--muted);font-size:13px;margin:10px 0 20px;">Qabulingiz tasdiqlandi! 30 daqiqa oldin eslatma yuboriladi.</p>
        <button class="btn btn-primary" onclick="document.getElementById('confirm-modal').classList.remove('open')">Yaxshi ‚úì</button>
      </div>
    </div>
  </div>
</div>

<!-- ===== SCREEN 3: ADMIN PANEL ===== -->
<div class="screen" id="screen-admin">
  <div class="layout">
    <div class="sidebar">
      <div class="sidebar-logo">
        <div class="s-logo-icon">üè•</div>
        <div><div class="s-logo-name">MedClinic</div><div class="s-logo-sub">Admin Panel</div></div>
      </div>
      <div class="sidebar-nav">
        <div class="nav-label">Asosiy</div>
        <div class="nav-item active" onclick="showAdminPage('dashboard',this)" id="anav-dashboard"><span class="nav-icon">üìä</span>Dashboard</div>
        <div class="nav-item" onclick="showAdminPage('bookings',this)" id="anav-bookings"><span class="nav-icon">üìÖ</span>Yozilganlar<span class="nav-badge" id="new-badge">0</span></div>
        <div class="nav-label" style="margin-top:10px;">Boshqaruv</div>
        <div class="nav-item" onclick="showAdminPage('doctors',this)" id="anav-doctors"><span class="nav-icon">üë®‚Äç‚öïÔ∏è</span>Shifokorlar</div>
        <div class="nav-item" onclick="showAdminPage('today',this)" id="anav-today"><span class="nav-icon">üåÖ</span>Bugungi qabul<span class="nav-badge warn" id="today-badge">0</span></div>
        <div class="nav-label" style="margin-top:10px;">Tizim</div>
        <div class="nav-item" onclick="showAdminPage('settings',this)" id="anav-settings"><span class="nav-icon">‚öôÔ∏è</span>Sozlamalar</div>
      </div>
      <div class="sidebar-footer">
        <div class="admin-user-card">
          <div class="admin-user-av">üëë</div>
          <div><div class="admin-user-name">Admin</div><div class="admin-user-role">Super Admin</div></div>
        </div>
        <button class="btn-logout" onclick="doAdminLogout()">üö™ Chiqish</button>
      </div>
    </div>

    <div class="admin-main">
      <div class="topbar">
        <div>
          <div class="topbar-title" id="topbar-title">Dashboard</div>
          <div class="topbar-sub" id="topbar-sub">Umumiy ko'rinish</div>
        </div>
        <div class="topbar-right">
          <div class="date-chip" id="date-chip"></div>
          <div class="notif-btn">üîî<div class="notif-dot" id="notif-dot" style="display:none;"></div></div>
        </div>
      </div>

      <div class="admin-content">

        <!-- DASHBOARD -->
        <div class="admin-page active" id="apage-dashboard">
          <div class="stats-grid">
            <div class="stat-card blue"><div class="stat-icon">üìã</div><div class="stat-val" id="stat-total">0</div><div class="stat-label">Jami yozilganlar</div></div>
            <div class="stat-card green"><div class="stat-icon">‚úÖ</div><div class="stat-val" id="stat-confirmed">0</div><div class="stat-label">Tasdiqlangan</div></div>
            <div class="stat-card yellow"><div class="stat-icon">üÜï</div><div class="stat-val" id="stat-new">0</div><div class="stat-label">Yangi</div></div>
            <div class="stat-card purple"><div class="stat-icon">üåÖ</div><div class="stat-val" id="stat-today">0</div><div class="stat-label">Bugun</div></div>
          </div>
          <div class="a-section">
            <div class="a-section-head">
              <div><div class="a-section-title">Oxirgi yozilganlar</div><div class="a-section-sub">Eng yangi 5 ta</div></div>
              <button class="btn-sm btn-accent" onclick="showAdminPage('bookings',document.getElementById('anav-bookings'))">Barchasini ko'rish</button>
            </div>
            <div class="table-wrap"><table><thead><tr><th>#</th><th>Bemor</th><th>Shifokor</th><th>Sana/Vaqt</th><th>Status</th></tr></thead><tbody id="dash-tbody"></tbody></table></div>
          </div>
        </div>

        <!-- BOOKINGS -->
        <div class="admin-page" id="apage-bookings">
          <div class="filters">
            <input type="text" class="filter-inp" id="search-inp" placeholder="üîç Ism yoki telefon..." oninput="renderBookings()" style="flex:1;min-width:160px;">
            <select class="filter-select" id="filter-status" onchange="renderBookings()">
              <option value="">Barcha statuslar</option>
              <option value="new">Yangi</option>
              <option value="confirmed">Tasdiqlangan</option>
              <option value="done">Bajarilgan</option>
              <option value="cancelled">Bekor</option>
            </select>
            <select class="filter-select" id="filter-doctor" onchange="renderBookings()">
              <option value="">Barcha shifokorlar</option>
              <option>Dr. Aziz Karimov ‚Äî Stomatolog</option>
              <option>Dr. Nilufar Yusupova ‚Äî LOR</option>
              <option>Dr. Sardor Toshmatov ‚Äî Pediatr</option>
              <option>Dr. Mohira Xasanova ‚Äî Kardiolog</option>
            </select>
            <input type="date" class="filter-inp" id="filter-date" onchange="renderBookings()">
            <button class="btn-sm btn-ghost" onclick="clearFilters()">‚úï Tozalash</button>
            <button class="btn-sm btn-accent" onclick="openAddModal()">+ Qo'shish</button>
          </div>
          <div class="table-wrap"><table><thead><tr><th>#</th><th>Bemor</th><th>Telefon</th><th>Shifokor</th><th>Sana</th><th>Vaqt</th><th>Status</th><th>Amallar</th></tr></thead><tbody id="bookings-tbody"></tbody></table></div>
          <div style="margin-top:10px;font-size:12px;color:var(--muted);" id="bookings-count"></div>
        </div>

        <!-- DOCTORS -->
        <div class="admin-page" id="apage-doctors">
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:14px;">
            <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;"><div style="display:flex;align-items:center;gap:10px;margin-bottom:12px;"><div style="width:44px;height:44px;background:linear-gradient(135deg,#38bdf8,#0ea5e9);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;">ü¶∑</div><div><div style="font-weight:700;color:var(--white);font-size:14px;">Dr. Aziz Karimov</div><div style="font-size:12px;color:var(--accent);">Stomatolog</div></div></div><div style="font-size:12px;color:var(--muted);line-height:1.7;">‚è∞ 08:00‚Äì18:00 ¬∑ ‚≠ê 4.9 ¬∑ üïê 8 yil</div><div id="dstat-0" style="margin-top:10px;font-size:12px;color:var(--accent2);"></div></div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;"><div style="display:flex;align-items:center;gap:10px;margin-bottom:12px;"><div style="width:44px;height:44px;background:linear-gradient(135deg,#34d399,#059669);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;">üëÅÔ∏è</div><div><div style="font-weight:700;color:var(--white);font-size:14px;">Dr. Nilufar Yusupova</div><div style="font-size:12px;color:var(--accent2);">LOR</div></div></div><div style="font-size:12px;color:var(--muted);line-height:1.7;">‚è∞ 09:00‚Äì17:00 ¬∑ ‚≠ê 4.8 ¬∑ üïê 12 yil</div><div id="dstat-1" style="margin-top:10px;font-size:12px;color:var(--accent2);"></div></div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;"><div style="display:flex;align-items:center;gap:10px;margin-bottom:12px;"><div style="width:44px;height:44px;background:linear-gradient(135deg,#fbbf24,#d97706);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;">üë∂</div><div><div style="font-weight:700;color:var(--white);font-size:14px;">Dr. Sardor Toshmatov</div><div style="font-size:12px;color:var(--warning);">Pediatr</div></div></div><div style="font-size:12px;color:var(--muted);line-height:1.7;">‚è∞ 08:00‚Äì20:00 ¬∑ ‚≠ê 4.9 ¬∑ üïê 6 yil</div><div id="dstat-2" style="margin-top:10px;font-size:12px;color:var(--accent2);"></div></div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;"><div style="display:flex;align-items:center;gap:10px;margin-bottom:12px;"><div style="width:44px;height:44px;background:linear-gradient(135deg,#a78bfa,#7c3aed);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;">ü´Ä</div><div><div style="font-weight:700;color:var(--white);font-size:14px;">Dr. Mohira Xasanova</div><div style="font-size:12px;color:var(--purple);">Kardiolog</div></div></div><div style="font-size:12px;color:var(--muted);line-height:1.7;">‚è∞ 10:00‚Äì16:00 ¬∑ ‚≠ê 5.0 ¬∑ üïê 15 yil</div><div id="dstat-3" style="margin-top:10px;font-size:12px;color:var(--accent2);"></div></div>
          </div>
        </div>

        <!-- TODAY -->
        <div class="admin-page" id="apage-today">
          <div class="table-wrap"><table><thead><tr><th>Vaqt</th><th>Bemor</th><th>Telefon</th><th>Shifokor</th><th>Izoh</th><th>Status</th><th>Amallar</th></tr></thead><tbody id="today-tbody"></tbody></table></div>
        </div>

        <!-- SETTINGS -->
        <div class="admin-page" id="apage-settings">
          <div style="max-width:460px;">
            <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:22px;margin-bottom:14px;">
              <div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:14px;">üîë Parolni o'zgartirish</div>
              <input type="password" class="inp" id="old-pass" placeholder="Eski parol">
              <input type="password" class="inp" id="new-pass" placeholder="Yangi parol">
              <input type="password" class="inp" id="new-pass2" placeholder="Yangi parolni tasdiqlash">
              <button class="btn-sm btn-accent" style="width:100%;padding:11px;font-size:13px;margin-top:4px;" onclick="changePass()">Saqlash</button>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:16px;padding:22px;">
              <div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:14px;">üë• Ro'yxatdan o'tgan foydalanuvchilar</div>
              <div id="users-list"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ADD/EDIT MODAL -->
  <div class="a-modal-overlay" id="booking-modal">
    <div class="a-modal">
      <h3 id="bm-title">Yangi yozilish</h3>
      <div class="a-modal-sub" id="bm-sub">Ma'lumotlarni to'ldiring</div>
      <div class="m-row"><input type="text" class="inp" id="m-name" placeholder="Ism Familiya" style="flex:1;margin:0;"><input type="tel" class="inp" id="m-phone" placeholder="Telefon" style="flex:1;margin:0;"></div>
      <select class="inp" id="m-doctor" style="margin-bottom:10px;">
        <option value="">Shifokor tanlang</option>
        <option>Dr. Aziz Karimov ‚Äî Stomatolog</option>
        <option>Dr. Nilufar Yusupova ‚Äî LOR</option>
        <option>Dr. Sardor Toshmatov ‚Äî Pediatr</option>
        <option>Dr. Mohira Xasanova ‚Äî Kardiolog</option>
      </select>
      <div class="m-row">
        <input type="date" class="inp" id="m-date" style="flex:1;margin:0;">
        <select class="inp" id="m-time" style="flex:1;margin:0;"><option value="">Vaqt</option><option>08:00</option><option>08:30</option><option>09:00</option><option>09:30</option><option>10:00</option><option>10:30</option><option>11:00</option><option>11:30</option><option>14:00</option><option>14:30</option><option>15:00</option><option>15:30</option><option>16:00</option><option>16:30</option></select>
      </div>
      <select class="inp" id="m-status" style="margin:10px 0 0;"><option value="new">üÜï Yangi</option><option value="confirmed">‚úÖ Tasdiqlangan</option><option value="done">üèÅ Bajarilgan</option><option value="cancelled">‚ùå Bekor</option></select>
      <input type="text" class="inp" id="m-note" placeholder="Izoh (ixtiyoriy)" style="margin-top:10px;">
      <div class="m-footer">
        <button class="btn-sm btn-ghost" onclick="closeModal()">Bekor</button>
        <button class="btn-sm btn-accent" onclick="saveBooking()">üíæ Saqlash</button>
      </div>
    </div>
  </div>

  <!-- DETAIL MODAL -->
  <div class="a-modal-overlay" id="detail-modal">
    <div class="a-modal">
      <h3>üìã Batafsil</h3>
      <div class="a-modal-sub" id="detail-id-lbl"></div>
      <div id="detail-content"></div>
      <div style="display:flex;gap:8px;margin-top:16px;">
        <button class="btn-sm btn-ghost" style="flex:1;" onclick="closeDetail()">Yopish</button>
        <button class="btn-sm btn-accent" style="flex:1;" id="detail-confirm-btn">‚úÖ Tasdiqlash</button>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// ============================================================
// DATA
// ============================================================
let bookings = [];
let editingId = null;
let adminPass = '1234';
let currentUser = null; // { fname, lname, phone, pass }

function loadBookings() {
  const s = localStorage.getItem('mc_bookings');
  if (s) bookings = JSON.parse(s);
  else {
    const today = new Date().toISOString().split('T')[0];
    bookings = [
      { id:1, name:'Alisher Karimov', phone:'+998901234567', doctor:'Dr. Aziz Karimov ‚Äî Stomatolog', date:today, time:'09:00', status:'new', note:'Tish og\'rig\'i', created:Date.now()-3600000 },
      { id:2, name:'Malika Yusupova', phone:'+998997654321', doctor:'Dr. Nilufar Yusupova ‚Äî LOR', date:today, time:'10:30', status:'confirmed', note:'', created:Date.now()-7200000 },
      { id:3, name:'Bobur Toshmatov', phone:'+998901111222', doctor:'Dr. Sardor Toshmatov ‚Äî Pediatr', date:today, time:'11:00', status:'new', note:'Bola 5 yoshda, isitma', created:Date.now()-1800000 },
    ];
    saveBookings();
  }
}
function saveBookings() { localStorage.setItem('mc_bookings', JSON.stringify(bookings)); }

function getUsers() {
  const s = localStorage.getItem('mc_users');
  return s ? JSON.parse(s) : [];
}
function saveUsers(u) { localStorage.setItem('mc_users', JSON.stringify(u)); }

// ============================================================
// AUTH TABS
// ============================================================
function switchTab(tab) {
  ['register','login','admin'].forEach(t => {
    document.getElementById('form-'+t).style.display = t===tab ? 'block' : 'none';
  });
  document.getElementById('tab-register').classList.toggle('active', tab==='register');
  document.getElementById('tab-login').classList.toggle('active', tab==='login' || tab==='admin');
  ['r-err','r-ok','l-err','a-err'].forEach(id => { document.getElementById(id).style.display='none'; });
}

function showErr(id, msg) {
  const el = document.getElementById(id);
  el.textContent = '‚ùå ' + msg;
  el.style.display = 'block';
}
function showOk(id, msg) {
  const el = document.getElementById(id);
  el.textContent = '‚úÖ ' + msg;
  el.style.display = 'block';
}

// ============================================================
// REGISTER
// ============================================================
function doRegister() {
  const fname = document.getElementById('r-fname').value.trim();
  const lname = document.getElementById('r-lname').value.trim();
  const phone = document.getElementById('r-phone').value.trim();
  const pass = document.getElementById('r-pass').value;
  const pass2 = document.getElementById('r-pass2').value;

  if (!fname || !lname) { showErr('r-err', 'Ism va familiyani kiriting'); return; }
  if (!phone) { showErr('r-err', 'Telefon raqamni kiriting'); return; }
  if (pass.length < 4) { showErr('r-err', 'Parol kamida 4 belgi bo\'lsin'); return; }
  if (pass !== pass2) { showErr('r-err', 'Parollar mos kelmadi'); return; }

  const users = getUsers();
  if (users.find(u => u.phone === phone)) { showErr('r-err', 'Bu telefon raqam allaqachon ro\'yxatdan o\'tgan'); return; }

  const newUser = { id: Date.now(), fname, lname, phone, pass, created: Date.now() };
  users.push(newUser);
  saveUsers(users);

  showOk('r-ok', 'Muvaffaqiyatli ro\'yxatdan o\'tdingiz! Endi kiring.');
  setTimeout(() => {
    switchTab('login');
    document.getElementById('l-phone').value = phone;
  }, 1500);
}

// ============================================================
// USER LOGIN
// ============================================================
function doLogin() {
  const phone = document.getElementById('l-phone').value.trim();
  const pass = document.getElementById('l-pass').value;
  if (!phone || !pass) { showErr('l-err', 'Barcha maydonlarni to\'ldiring'); return; }

  const users = getUsers();
  const user = users.find(u => u.phone === phone && u.pass === pass);
  if (!user) { showErr('l-err', 'Telefon yoki parol noto\'g\'ri'); return; }

  currentUser = user;
  loadBookings();
  enterApp();
}

// ============================================================
// ADMIN LOGIN
// ============================================================
function doAdminLogin() {
  const u = document.getElementById('a-user').value.trim();
  const p = document.getElementById('a-pass').value;
  if (u === 'admin' && p === adminPass) {
    loadBookings();
    document.getElementById('screen-auth').classList.remove('active');
    document.getElementById('screen-admin').classList.add('active');
    initAdmin();
  } else {
    showErr('a-err', 'Admin login yoki parol noto\'g\'ri');
  }
}
document.addEventListener('keydown', e => {
  if (e.key === 'Enter') {
    if (document.getElementById('form-register').style.display !== 'none') doRegister();
    else if (document.getElementById('form-login').style.display !== 'none') doLogin();
    else if (document.getElementById('form-admin').style.display !== 'none') doAdminLogin();
  }
});

// ============================================================
// APP ENTRY
// ============================================================
function enterApp() {
  document.getElementById('screen-auth').classList.remove('active');
  document.getElementById('screen-app').classList.add('active');

  const fullName = currentUser.fname + ' ' + currentUser.lname;
  document.getElementById('app-user-name').textContent = currentUser.fname;
  document.getElementById('app-user-av').textContent = currentUser.fname[0].toUpperCase();
  document.getElementById('home-welcome').textContent = 'Xush kelibsiz, ' + currentUser.fname + '! üëã';
  document.getElementById('app-greet').textContent = 'Shifokorga yoziling yoki ma\'lumot oling';

  // prefill booking name & phone
  document.getElementById('b-name').value = fullName;
  document.getElementById('b-phone').value = currentUser.phone;
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('b-date').value = today;
  document.getElementById('b-date').min = today;

  renderProfile();
}

function doAppLogout() {
  currentUser = null;
  document.getElementById('screen-app').classList.remove('active');
  document.getElementById('screen-auth').classList.add('active');
  // reset pages
  document.querySelectorAll('#screen-app .page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-home').classList.add('active');
  document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
  document.getElementById('ptab-home').classList.add('active');
}

function showUserMenu() { showPage('profile'); }

// ============================================================
// APP PAGES
// ============================================================
function showPage(id) {
  document.querySelectorAll('#screen-app .page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
  document.getElementById('page-'+id).classList.add('active');
  document.getElementById('ptab-'+id).classList.add('active');
  if (id === 'profile') renderProfile();
}

function selectDoctor(name) {
  showPage('booking');
  document.getElementById('b-doctor').value = name;
}

const symptoms = {
  head: { title:'üß† Nevropatolog / Terapevist', text:'Bosh og\'riq nevrologik yoki qon bosimi muammosi bo\'lishi mumkin. Nevropatolog yoki terapevist tavsiya etiladi.' },
  teeth: { title:'ü¶∑ Stomatolog ‚Äî Dr. Aziz Karimov', text:'Tish og\'rig\'i uchun stomatologga murojaat qiling. 08:00‚Äì18:00 gacha qabul bor.' },
  stomach: { title:'üçÉ Gastroenterolog / Terapevist', text:'Qorin og\'rig\'i uchun dastlab terapevistga, so\'ngra gastroenterologga murojaat tavsiya etiladi.' },
  heart: { title:'ü´Ä Kardiolog ‚Äî Dr. Mohira Xasanova', text:'Ko\'krak og\'rig\'i kardialogik muammo bo\'lishi mumkin. Imkon qadar tezroq kardiologga murojaat qiling.' },
  nose: { title:'üëÉ LOR ‚Äî Dr. Nilufar Yusupova', text:'Burun, tomoq yoki quloq muammolari uchun LOR mutaxassisi tavsiya etiladi.' },
  child: { title:'üë∂ Pediatr ‚Äî Dr. Sardor Toshmatov', text:'18 yoshgacha bolalar uchun pediatr mutaxassisi. Kasallik alomatlari bo\'lsa darhol murojaat qiling.' },
  eye: { title:'üëÅÔ∏è Oftalmolog', text:'Ko\'z muammolari uchun oftalmologga murojaat tavsiya etiladi.' },
  joint: { title:'ü¶¥ Travmatolog / Revmatolog', text:'Bo\'g\'im og\'rig\'i uchun travmatolog yoki revmatologga murojaat qiling.' },
};

function showResult(el, key) {
  document.querySelectorAll('.symptom-btn').forEach(b => b.classList.remove('selected'));
  el.classList.add('selected');
  const r = symptoms[key];
  document.getElementById('result-title').textContent = r.title;
  document.getElementById('result-text').textContent = r.text;
  document.getElementById('result-box').style.display = 'block';
}

// ============================================================
// BOOKING
// ============================================================
function openConfirm() {
  const name = document.getElementById('b-name').value.trim();
  const phone = document.getElementById('b-phone').value.trim();
  const doctor = document.getElementById('b-doctor').value;
  const date = document.getElementById('b-date').value;
  const time = document.getElementById('b-time').value;
  if (!name || !phone || !doctor || !date || !time) { alert('Iltimos, barcha maydonlarni to\'ldiring!'); return; }
  document.getElementById('confirm-details').innerHTML = `
    <div class="confirm-row"><span class="confirm-label">Ism:</span><span class="confirm-val">${name}</span></div>
    <div class="confirm-row"><span class="confirm-label">Telefon:</span><span class="confirm-val">${phone}</span></div>
    <div class="confirm-row"><span class="confirm-label">Shifokor:</span><span class="confirm-val">${doctor}</span></div>
    <div class="confirm-row"><span class="confirm-label">Sana:</span><span class="confirm-val">${date}</span></div>
    <div class="confirm-row"><span class="confirm-label">Vaqt:</span><span class="confirm-val">${time}</span></div>
  `;
  document.getElementById('modal-confirm-form').style.display = 'block';
  document.getElementById('modal-confirm-success').style.display = 'none';
  document.getElementById('confirm-modal').classList.add('open');
}
function closeConfirmOutside(e) { if(e.target===document.getElementById('confirm-modal')) document.getElementById('confirm-modal').classList.remove('open'); }

function submitBooking() {
  const name = document.getElementById('b-name').value.trim();
  const phone = document.getElementById('b-phone').value.trim();
  const doctor = document.getElementById('b-doctor').value;
  const date = document.getElementById('b-date').value;
  const time = document.getElementById('b-time').value;
  const note = document.getElementById('b-note').value.trim();
  const newId = bookings.length ? Math.max(...bookings.map(b=>b.id))+1 : 1;
  bookings.push({ id:newId, name, phone, doctor, date, time, status:'new', note, created:Date.now(), userId: currentUser?.id });
  saveBookings();
  document.getElementById('modal-confirm-form').style.display = 'none';
  document.getElementById('modal-confirm-success').style.display = 'block';
  document.getElementById('b-doctor').value = '';
  document.getElementById('b-time').value = '';
  document.getElementById('b-note').value = '';
}

// ============================================================
// PROFILE
// ============================================================
function renderProfile() {
  if (!currentUser) return;
  document.getElementById('profile-info').innerHTML = `
    <div style="display:flex;align-items:center;gap:14px;margin-bottom:4px;">
      <div style="width:56px;height:56px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:26px;font-weight:700;color:#0a1a10;">${currentUser.fname[0]}</div>
      <div>
        <div style="font-size:18px;font-weight:700;color:var(--white);">${currentUser.fname} ${currentUser.lname}</div>
        <div style="font-size:13px;color:var(--accent);">${currentUser.phone}</div>
        <div style="font-size:11px;color:var(--muted);margin-top:3px;">A'zo bo'lgan: ${new Date(currentUser.created).toLocaleDateString('uz-UZ')}</div>
      </div>
    </div>
  `;
  const myB = bookings.filter(b => b.userId === currentUser.id).sort((a,b) => b.created-a.created);
  const el = document.getElementById('my-bookings-list');
  if (!myB.length) {
    el.innerHTML = '<div style="text-align:center;padding:20px;color:var(--muted);font-size:13px;">Hali yozilishlaringiz yo\'q</div>';
  } else {
    el.innerHTML = myB.map(b => `
      <div style="padding:12px 0;border-bottom:1px solid var(--border);">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div style="font-weight:600;font-size:13px;color:var(--white);">${b.doctor.split('‚Äî')[0].trim()}</div>
          ${statusBadge(b.status)}
        </div>
        <div style="font-size:12px;color:var(--muted);margin-top:4px;">üìÖ ${b.date} ¬∑ ‚è∞ ${b.time}</div>
        ${b.note ? `<div style="font-size:12px;color:var(--muted);margin-top:2px;">üìù ${b.note}</div>` : ''}
      </div>
    `).join('') + '<div style="height:4px;"></div>';
  }
}

// ============================================================
// ADMIN FUNCTIONS
// ============================================================
function initAdmin() {
  updateStats(); updateBadges(); renderDashboard(); renderBookings(); renderToday(); renderDoctorStats();
  updateDateTime(); setInterval(updateDateTime, 60000);
}

function doAdminLogout() {
  document.getElementById('screen-admin').classList.remove('active');
  document.getElementById('screen-auth').classList.add('active');
  document.getElementById('a-pass').value = '';
}

function showAdminPage(id, el) {
  document.querySelectorAll('.admin-page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('apage-'+id).classList.add('active');
  if (el) el.classList.add('active');
  const titles = { dashboard:['Dashboard','Umumiy ko\'rinish'], bookings:['Yozilganlar','Barcha qabul so\'rovlari'], doctors:['Shifokorlar','Mutaxassislar'], today:['Bugungi qabul','Bugun kelishi kerak'], settings:['Sozlamalar','Tizim sozlamalari'] };
  const t = titles[id];
  if (t) { document.getElementById('topbar-title').textContent = t[0]; document.getElementById('topbar-sub').textContent = t[1]; }
  if (id==='bookings') renderBookings();
  if (id==='today') renderToday();
  if (id==='doctors') renderDoctorStats();
  if (id==='dashboard') renderDashboard();
  if (id==='settings') renderUsersList();
}

function updateStats() {
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('stat-total').textContent = bookings.length;
  document.getElementById('stat-confirmed').textContent = bookings.filter(b=>b.status==='confirmed').length;
  document.getElementById('stat-new').textContent = bookings.filter(b=>b.status==='new').length;
  document.getElementById('stat-today').textContent = bookings.filter(b=>b.date===today).length;
}
function updateBadges() {
  const today = new Date().toISOString().split('T')[0];
  const nc = bookings.filter(b=>b.status==='new').length;
  const tc = bookings.filter(b=>b.date===today&&(b.status==='new'||b.status==='confirmed')).length;
  document.getElementById('new-badge').textContent = nc;
  document.getElementById('today-badge').textContent = tc;
  document.getElementById('notif-dot').style.display = nc>0?'block':'none';
}
function updateDateTime() {
  const now = new Date();
  document.getElementById('date-chip').textContent = now.toLocaleDateString('uz-UZ',{weekday:'short',day:'numeric',month:'short'});
}

function statusBadge(s) {
  const m = { new:['status-new','üÜï Yangi'], confirmed:['status-confirmed','‚úÖ Tasdiqlangan'], done:['status-done','üèÅ Bajarilgan'], cancelled:['status-cancelled','‚ùå Bekor'] };
  const [cls,label] = m[s]||['status-new',s];
  return `<span class="status-badge ${cls}">${label}</span>`;
}

function renderDashboard() {
  updateStats();
  const recent = [...bookings].sort((a,b)=>b.created-a.created).slice(0,5);
  const tbody = document.getElementById('dash-tbody');
  if (!recent.length) { tbody.innerHTML=`<tr><td colspan="5"><div class="empty-state"><div class="empty-icon">üì≠</div><div class="empty-text">Yozilganlar yo'q</div></div></td></tr>`; return; }
  tbody.innerHTML = recent.map(b=>`<tr><td style="color:var(--muted);font-size:11px;">#${b.id}</td><td><div class="td-name">${b.name}</div></td><td style="font-size:12px;">${b.doctor.split('‚Äî')[0].trim()}</td><td class="td-date">${b.date} ${b.time}</td><td>${statusBadge(b.status)}</td></tr>`).join('');
}

function renderBookings() {
  const search = (document.getElementById('search-inp')?.value||'').toLowerCase();
  const sf = document.getElementById('filter-status')?.value||'';
  const df = document.getElementById('filter-doctor')?.value||'';
  const dtf = document.getElementById('filter-date')?.value||'';
  let f = bookings.filter(b=>{
    if(search && !b.name.toLowerCase().includes(search) && !b.phone.includes(search)) return false;
    if(sf && b.status!==sf) return false;
    if(df && b.doctor!==df) return false;
    if(dtf && b.date!==dtf) return false;
    return true;
  }).sort((a,b)=>b.created-a.created);
  document.getElementById('bookings-count').textContent = `Topildi: ${f.length} ta`;
  const tbody = document.getElementById('bookings-tbody');
  if(!f.length){tbody.innerHTML=`<tr><td colspan="8"><div class="empty-state"><div class="empty-icon">üîç</div><div class="empty-text">Topilmadi</div></div></td></tr>`;return;}
  tbody.innerHTML = f.map(b=>`<tr><td style="color:var(--muted);font-size:11px;">#${b.id}</td><td><div class="td-name">${b.name}</div></td><td><div class="td-phone">${b.phone}</div></td><td style="font-size:12px;max-width:140px;">${b.doctor}</td><td class="td-date">${b.date}</td><td class="td-date">${b.time}</td><td>${statusBadge(b.status)}</td><td><span class="action-btn" onclick="viewBooking(${b.id})">üëÅÔ∏è</span><span class="action-btn" onclick="editBooking(${b.id})">‚úèÔ∏è</span><span class="action-btn danger" onclick="deleteBooking(${b.id})">üóëÔ∏è</span></td></tr>`).join('');
}

function renderToday() {
  const today = new Date().toISOString().split('T')[0];
  const list = bookings.filter(b=>b.date===today).sort((a,b)=>a.time.localeCompare(b.time));
  const tbody = document.getElementById('today-tbody');
  if(!list.length){tbody.innerHTML=`<tr><td colspan="7"><div class="empty-state"><div class="empty-icon">üåÖ</div><div class="empty-text">Bugun yozilganlar yo'q</div></div></td></tr>`;return;}
  tbody.innerHTML = list.map(b=>`<tr><td style="font-weight:700;color:var(--accent);">${b.time}</td><td><div class="td-name">${b.name}</div></td><td class="td-phone">${b.phone}</td><td style="font-size:12px;">${b.doctor}</td><td style="font-size:12px;color:var(--muted);">${b.note||'‚Äî'}</td><td>${statusBadge(b.status)}</td><td>${b.status==='new'?`<button class="btn-sm btn-accent" style="padding:5px 10px;font-size:11px;" onclick="quickConfirm(${b.id})">‚úÖ Tasdiqlash</button>`:''}${b.status==='confirmed'?`<button class="btn-sm" style="padding:5px 10px;font-size:11px;background:rgba(52,211,153,0.1);border:1px solid rgba(52,211,153,0.2);color:var(--accent2);" onclick="quickDone(${b.id})">üèÅ Bajarildi</button>`:''}</td></tr>`).join('');
}

function renderDoctorStats() {
  const docs = ['Dr. Aziz Karimov ‚Äî Stomatolog','Dr. Nilufar Yusupova ‚Äî LOR','Dr. Sardor Toshmatov ‚Äî Pediatr','Dr. Mohira Xasanova ‚Äî Kardiolog'];
  const today = new Date().toISOString().split('T')[0];
  docs.forEach((d,i)=>{
    const c = bookings.filter(b=>b.doctor===d).length;
    const tc = bookings.filter(b=>b.doctor===d&&b.date===today).length;
    document.getElementById('dstat-'+i).textContent = `üìä Jami: ${c} ta | Bugun: ${tc} ta`;
  });
}

function renderUsersList() {
  const users = getUsers();
  const el = document.getElementById('users-list');
  if (!users.length) { el.innerHTML='<div style="font-size:13px;color:var(--muted);">Hali foydalanuvchilar yo\'q</div>'; return; }
  el.innerHTML = users.map(u=>`
    <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--border);">
      <div style="display:flex;align-items:center;gap:10px;">
        <div style="width:34px;height:34px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;color:#0a1a10;">${u.fname[0]}</div>
        <div><div style="font-weight:600;font-size:13px;color:var(--white);">${u.fname} ${u.lname}</div><div style="font-size:12px;color:var(--muted);">${u.phone}</div></div>
      </div>
      <div style="font-size:12px;color:var(--muted);">${bookings.filter(b=>b.userId===u.id).length} ta yozilish</div>
    </div>
  `).join('');
}

function openAddModal() {
  editingId=null;
  document.getElementById('bm-title').textContent='‚ûï Yangi yozilish';
  document.getElementById('bm-sub').textContent='Ma\'lumotlarni to\'ldiring';
  ['m-name','m-phone','m-note'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('m-doctor').value='';
  document.getElementById('m-date').value=new Date().toISOString().split('T')[0];
  document.getElementById('m-time').value='';
  document.getElementById('m-status').value='new';
  document.getElementById('booking-modal').classList.add('open');
}
function editBooking(id) {
  const b=bookings.find(x=>x.id===id); if(!b) return;
  editingId=id;
  document.getElementById('bm-title').textContent='‚úèÔ∏è Tahrirlash';
  document.getElementById('bm-sub').textContent=`Yozilish #${id}`;
  document.getElementById('m-name').value=b.name;
  document.getElementById('m-phone').value=b.phone;
  document.getElementById('m-doctor').value=b.doctor;
  document.getElementById('m-date').value=b.date;
  document.getElementById('m-time').value=b.time;
  document.getElementById('m-status').value=b.status;
  document.getElementById('m-note').value=b.note||'';
  document.getElementById('booking-modal').classList.add('open');
}
function saveBooking() {
  const name=document.getElementById('m-name').value.trim();
  const phone=document.getElementById('m-phone').value.trim();
  const doctor=document.getElementById('m-doctor').value;
  const date=document.getElementById('m-date').value;
  const time=document.getElementById('m-time').value;
  const status=document.getElementById('m-status').value;
  const note=document.getElementById('m-note').value.trim();
  if(!name||!phone||!doctor||!date||!time){showToast('‚ùó Barcha maydonlarni to\'ldiring',true);return;}
  if(editingId){
    const idx=bookings.findIndex(b=>b.id===editingId);
    bookings[idx]={...bookings[idx],name,phone,doctor,date,time,status,note};
    showToast('‚úÖ Yangilandi');
  } else {
    const nid=bookings.length?Math.max(...bookings.map(b=>b.id))+1:1;
    bookings.push({id:nid,name,phone,doctor,date,time,status,note,created:Date.now()});
    showToast('‚úÖ Qo\'shildi');
  }
  saveBookings(); updateStats(); updateBadges(); closeModal(); renderBookings(); renderDashboard();
}
function deleteBooking(id) {
  if(!confirm('O\'chirishni xohlaysizmi?')) return;
  bookings=bookings.filter(b=>b.id!==id);
  saveBookings(); updateStats(); updateBadges(); renderBookings(); renderDashboard(); renderToday();
  showToast('üóëÔ∏è O\'chirildi');
}
function viewBooking(id) {
  const b=bookings.find(x=>x.id===id); if(!b) return;
  document.getElementById('detail-id-lbl').textContent=`Yozilish #${b.id}`;
  document.getElementById('detail-content').innerHTML=`
    <div class="detail-row"><span class="detail-label">Ism</span><span class="detail-val">${b.name}</span></div>
    <div class="detail-row"><span class="detail-label">Telefon</span><span class="detail-val" style="color:var(--accent);">${b.phone}</span></div>
    <div class="detail-row"><span class="detail-label">Shifokor</span><span class="detail-val">${b.doctor}</span></div>
    <div class="detail-row"><span class="detail-label">Sana</span><span class="detail-val">${b.date}</span></div>
    <div class="detail-row"><span class="detail-label">Vaqt</span><span class="detail-val">${b.time}</span></div>
    <div class="detail-row"><span class="detail-label">Status</span><span class="detail-val">${statusBadge(b.status)}</span></div>
    <div class="detail-row"><span class="detail-label">Izoh</span><span class="detail-val">${b.note||'‚Äî'}</span></div>
  `;
  const btn=document.getElementById('detail-confirm-btn');
  btn.style.display=b.status==='new'?'block':'none';
  btn.onclick=()=>{quickConfirm(id);closeDetail();};
  document.getElementById('detail-modal').classList.add('open');
}
function quickConfirm(id){const b=bookings.find(x=>x.id===id);if(b){b.status='confirmed';saveBookings();updateStats();updateBadges();renderBookings();renderToday();renderDashboard();showToast('‚úÖ Tasdiqlandi');}}
function quickDone(id){const b=bookings.find(x=>x.id===id);if(b){b.status='done';saveBookings();updateStats();updateBadges();renderToday();renderBookings();renderDashboard();showToast('üèÅ Bajarilgan');}}
function closeModal(){document.getElementById('booking-modal').classList.remove('open');}
function closeDetail(){document.getElementById('detail-modal').classList.remove('open');}
document.getElementById('booking-modal').addEventListener('click',e=>{if(e.target===document.getElementById('booking-modal'))closeModal();});
document.getElementById('detail-modal').addEventListener('click',e=>{if(e.target===document.getElementById('detail-modal'))closeDetail();});
function clearFilters(){['search-inp','filter-date'].forEach(id=>document.getElementById(id).value='');['filter-status','filter-doctor'].forEach(id=>document.getElementById(id).value='');renderBookings();}
function changePass(){
  const old=document.getElementById('old-pass').value;
  const n1=document.getElementById('new-pass').value;
  const n2=document.getElementById('new-pass2').value;
  if(old!==adminPass){showToast('‚ùå Eski parol noto\'g\'ri',true);return;}
  if(n1!==n2){showToast('‚ùå Parollar mos kelmadi',true);return;}
  if(n1.length<4){showToast('‚ùå Parol 4 belgidan kam bo\'lmasin',true);return;}
  adminPass=n1; showToast('‚úÖ Parol o\'zgartirildi');
}
function showToast(msg,isErr=false){
  const t=document.getElementById('toast');
  t.textContent=msg;
  t.style.background=isErr?'var(--danger)':'var(--accent2)';
  t.style.color=isErr?'#fff':'#0a1a10';
  t.style.display='block';
  setTimeout(()=>{t.style.display='none';},2800);
}
</script>
</body>
</html>
